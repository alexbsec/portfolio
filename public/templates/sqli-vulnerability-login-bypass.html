{% extends "base.html" %}{% block title %}SQLi Vulnerability: Login Bypass{%endblock%}
{% block content %}
        <h1 id="typing-effect" class="display-2 mb-4"></h1>
        <p>
            <b class="solution-title">Solution</b>
        </p>
        <p class="solution-text no-indent">
            In this lab we are going to explore how one can use SQL injection in vulnerable 
            login fields. The lab asks us to login with the administrator credentials. You can access
            it by clicking <a class="fake-link" target="blank" href="https://portswigger.net/web-security/sql-injection/lab-login-bypass">
                here
            </a>.
        </p>
        <p class="solution-text no-indent">
            First of all, note that when we access the root page, we have an "My Account" link
            that should lead you to the login page, as shown below
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="{{ url_for('static', filename='img/sqli-vuln-login-bypass.png') }}">
        </div>
        <p class="solution-text no-indent">
            Note that when we try to login with an incorrect password for the user 'administrator', nothing
            really interesting happens. Alternatively, we can inject an SQL query to see whether the login
            field is indeed vulnerable to this kind of attack. To do so, instead of inputing a valid
            username, we type in --' as a login username. After attempting to login with this username,
            we should see the following page:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="{{ url_for('static', filename='img/sqli-vuln-login-bypass-2.png') }}">
        </div>
        <p class="solution-text no-indent">
            indicating that the query was accepted and the field is indeed vulnerable to SQL injections.
            In this case, we can assume that what the query is doing is somewhat similar to:

        </p>
        <code class="code-style">SELECT * FROM users WHERE username = '' AND password = ''</code>
        <p class="solution-text no-indent">
            If that is the case, we can then try to remove the AND clause and add an OR clause to
            force the login with any password that we provide. We can simply do that by adding to the
            login field the following:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="{{ url_for('static', filename='img/sqli-vuln-login-bypass-3.png') }}">
        </div>
        <p class="solution-text center">
            This should log you right into the administrator account, solving the lab!
        </p>
        <a href="/labs">Go back</a>
{% endblock %}