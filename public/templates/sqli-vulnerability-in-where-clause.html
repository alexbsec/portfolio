{% extends "base.html" %}{% block title %}SQLi Vulnerability in Where Clause{%endblock%}
{% block content %}
        <h1 id="typing-effect" class="display-2 mb-4"></h1>
        <p>
            <b class="solution-title">Solution</b>
        </p>
        <p class="solution-text no-indent">
            According to the lab description,
            we have a SQLi vunerability in the product category filter. Let us understand
            what it is meant by that. For simplicity, we will call our url lab <a class="fake-link" target="blank" href="https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data">portswigger-lab.web-security.net</a>. This link will also redirect you to the Lab webpage on PortSwigger website.
            As soon as we open the lab, we are welcomed to the iconic PortSwigger "We like to Shop" png
            image, which is so captivating. You should be able to see the page display to look something like
            this:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="{{ url_for('static', filename='img/sqli-vuln-where-clause-ret-hidden-data.png') }}">
        </div>
        <p class="solution-text no-indent">
            The lab asks us precisely
            what we need to retrieve in order to solve it, which is to inject an SQL query to display all products
            in all categories. It also states that the application carries out an SQL query like
        </p>
        <code class="code-style">SELECT * FROM products WHERE category = 'Gifts' AND released = 1</code>
        <p class="solution-text no-indent">
            and it states that the category filter is succeptible to SQL injection attacks. Click on the Accessories
            filter on the root page "/". Note that it redirects us to another url, which is something like
            <a class="fake-link">portswigger-lab.web-security.net/filter?category=Accessories</a>. Now let's see if this
            filter accepts SQL injection. Let's see what happens to this webpage when we append to the Accessories
            parameter the query: '--. The double dashes are meant to end the SQL query that happens in this filter.
            This should lead you to the following page:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="{{ url_for('static', filename='img/sqli-vuln-where-clause-ret-hidden-data-2.png') }}">
        </div>
        <p class="solution-text no-indent">
            indicating that the query was accepted. To see what is going on, the website API reads this input as:
        </p>
        <code class="code-style">SELECT * FROM products WHERE category = 'Accessories'--' AND released = 1</code>
        <p class="solution-text no-indent">
            The "AND" statement will not be processed, since we ended the query using the '-- input. This is yet not
            showing us all the products, released and unrealeased. To trigger this, we add to the filter <a class="fake-link">filter?category=Accessories'+OR+1=1--</a>
            What happens to the processed query is:
        </p>
        <code class="code-style">SELECT * FROM products WHERE category = 'Accessories' OR 1=1--' AND released = 1</code>
        <p class="solution-text no-indent">
            Again, the last piece will not be read by the program because of the double dashes added at the end of the query. Note that
             by adding the query "OR 1=1", we automatically trigger the website API to display all products, independently of the category,
             which means we can do this procedure in any other category, such as "Tech gifts", for instance. After this query, we display
             all the unrealeased products the lab asks about:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="{{ url_for('static', filename='img/sqli-vuln-where-clause-ret-hidden-data-3.png') }}">
        </div>
        <p class="solution-text center">
            Which solves the lab!
        </p>
        <a href="/labs">Go back</a>
{%endblock%}