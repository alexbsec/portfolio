<!DOCTYPE html>

<html lang="en">

    <head>
        <title>Joao C. Buschinelli</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <meta charset="utf-8">
        <title>Portfolio</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="canonical" href="https://getbootstrap.com/docs/4.0/examples/carousel/">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="vendor/bootstrap/bootstrap.min.css">
        <link rel="stylesheet" href="vendor/select2/select2.min.css">
        <link rel="stylesheet" href="vendor/owlcarousel/owl.carousel.min.css">
        <link rel="stylesheet" href="vendor/lightcase/lightcase.css">
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400|Work+Sans:300,400,700" rel="stylesheet">
        <link rel="stylesheet" href="../../css/style.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
        <script src="../../js/effect.js"></script>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top nav_left">
            <div class="container-fluid">
              <a class="navbar-brand" href="home.html">João Buschinelli</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse flex-d flex-row-reverse nav_right" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                  <a class="nav-link active" aria-current="page" href="../../home.html">Home</a>
                  <a class="nav-link" href="../../PortSwiggerLabs.html">Labs</a>
                  <a class="nav-link" href="../../about.html">About</a>
                  <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                </div>
              </div>
            </div>
            </nav>
<div class="jumbotron d-flex align-items-center">
    <div class="container text-center">
        <h1 id="typing-effect" class="display-2 mb-4"></h1>
        <p>
            <b class="solution-title">Solution</b>
        </p>
        <p class="solution-text no-indent">
            Differently from the last two labs about privilege escalation, this one requires the user to log in to gain access of "fobidden" folders. You can access
            it by clicking <a class="fake-link" target="blank" href="https://portswigger.net/web-security/access-control/lab-user-role-controlled-by-request-parameter">
            here</a>. The first approach I would take here is to log in and see the requests on BurpSuite. And my suspicion was correct. After logging in, see that
            we have a GET request on "/my-accout" directory.
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-1.png">
        </div>
        <p class="solution-text no-indent">
            There is an interesting cookie in this request. We see that a boolean value false is passed to the "Admin" cookie. What if we changed it to true?
            My next approach here is: log out, turn intercept on and forward all requests changing every "Admin" cookie to true at every interception.
            This should allow us to be seen as administrator by the website. The first thing (with intercept on) is to click on My Account link on homepage. This
            is the request that is sent:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-2.png">
        </div>
        <p class="solution-text no-indent">
            Change the cookie to true and forward it. The next request is:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-3.png">
        </div>
        <p class="solution-text no-indent">
            Do the same procedure as before. Next request:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-4.png">
        </div>
        <p class="solution-text no-indent">
            Forward with true and onto the next request:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-5.png">
        </div>
        <p class="solution-text no-indent">
            Finally, change it to true and forward. Now check the website. It should be something like this:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-6.png">
        </div>
        <p class="solution-text no-indent">
            Check that now we have another tab option: the "Admin panel". If we click it directly, it won't work, because there
            are more requests that uses the Admin cookie in this process. To actually access it, we have to do the same procedure as before.
            Intercept on and forward true to every Admin cookie you find on the way. After this, you should see the following page:
        </p> 
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="/home/joao/portfolio/Images/priv-esc-user-control-by-request-7.png">
        </div>
        <p class="solution-text center">
            Click delete on carlos account and the lab is solved!
        </p>
        <a href="/home/joao/portfolio/PortSwiggerLabs.html">Go back</a>
    </div>

</div>
<footer class="mt-auto text-white-50">
    
    <p>&copy; 2022<script>new Date().getFullYear()>2022&&document.write("-"+new Date().getFullYear());</script> <a class="text-white">hobo-hacker.com</a>, by <a href="https://www.linkedin.com/in/jo%C3%A3o-corr%C3%AAa-buschinelli-14bb59166/" class="text-white">João C. Buschinelli</a>.</p>
</footer>


</body>
