<!DOCTYPE html>

<html lang="en">

    <head>
        <title>Joao C. Buschinelli</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <meta charset="utf-8">
        <title>Portfolio</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="canonical" href="https://getbootstrap.com/docs/4.0/examples/carousel/">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="vendor/bootstrap/bootstrap.min.css">
        <link rel="stylesheet" href="vendor/select2/select2.min.css">
        <link rel="stylesheet" href="vendor/owlcarousel/owl.carousel.min.css">
        <link rel="stylesheet" href="vendor/lightcase/lightcase.css">
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400|Work+Sans:300,400,700" rel="stylesheet">
        <link rel="stylesheet" href="../../css/style.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
        <script src="../../js/effect.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top nav_left">
            <div class="container-fluid">
              <a class="navbar-brand" href="home.html">João Buschinelli</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse flex-d flex-row-reverse nav_right" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                  <a class="nav-link active" aria-current="page" href="../../home.html">Home</a>
                  <a class="nav-link" target="blank" href="https://github.com/buschinelli-joao/">GitHub</a>
                  <a class="nav-link" href="../../PortSwiggerLabs.html">Labs</a>
                  <a class="nav-link" href="../../ctfs.html">CTFs</a>
                  <a class="nav-link" href="../../about.html">About</a>
                </div>
              </div>
            </div>
            </nav>
<div class="jumbotron d-flex align-items-center">
    <div class="container text-center">
        <h1 id="typing-effect" class="display-2 mb-4"></h1>
        <p>
            <b class="solution-title">Solution</b>
        </p>
        <p class="solution-text">
            Similarly to the last lab (access <a class="fake-link" href="../../portswiggerlabs/apprentice/excessive-trust-in-client-side-controls.html">here</a>), we can access
            the website root page "/" and check around to see if something is off. After loggin in, we see that we have $100.00 credit. Yay! (click <a class="fake-link" target="blank" href="https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-high-level">here</a>  to access PortSwigger page of this lab).
        </p>

        <p class="solution-text no-indent">
            Let's go back to the root page and search for items to buy. I think this labs asks us
            to buy the Leather Jacket. Here is the logged in home page:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/high-level-logic-flaw.png">
        </div>
        <p class="solution-text no-indent">
            View details button on the Leather Jacket. This should lead to this page:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/high-level-logic-flaw-2.png">
        </div>
        <p class="solution-text no-indent">
            Now we just add this to cart and see the http request on BurpSuite. Ok... That's getting
            interesting. So, if you add to cart and then go to the "/cart" directory, BurpSuite should capture
            a POST request that has two important variables:
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/high-level-logic-flaw-3.png">
        </div>

        <p class="solution-text no-indent">
        Note that there is a "quantity" variable, that probably is referring to the number of
        items you added of that specific product. There's also a productId variable. This probably
        refers to the Leather Jacked id number stored in their database or something. The other parameter
        must be telling the program that this is a query design to the PRODUCTS section only. What happens if we add, say,
        a negative quantity? Let's send this request to Repeater and change the parameter to -1.
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/high-level-logic-flaw-4.png">
        </div>  
        <p class="solution-text no-indent">
            That's awesome! Now the price is negative. But I bet there is still a problem here.
            You see, websites usually prevent this kind of bugs by just setting the minimum price to be at least $0.01.
            But, just out of curiosity, let's try to finish our purchase the way it is right now.
        </p> 
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/high-level-logic-flaw-5.png">
        </div>  
        <p class="solution-text no-indent">
            Oops. That's what I expected. Not to worry! But before going any further, there is a catch here.
            Buying -1 product does not make sense. This would probably not work to bypass real websites (at least to the point
            where the negative quantity of the product that was ordered tells that that product was actually not bought). In that case, we 
            will add to the cart 1 Leather Jacket. After that, we add negative amounts of other products
            to leveraged down the price we have to pay (cause we are hackers hehehe). There is a product in my session that 
            costs $78.96. If we add -16 of this product in the cart, we probably will be able to purchase
            our jacket with an exploited price.
        </p>
        <p class="solution-text center">
            Which solves the lab!
        </p>
        <a href="../../PortSwiggerLabs.html">Go back</a>
    </div>

</div>
<footer class="mt-auto text-white-50">
    
    <p>&copy; 2022<script>new Date().getFullYear()>2022&&document.write("-"+new Date().getFullYear());</script> <a class="text-white">hobo-hacker.com</a>, by <a href="https://www.linkedin.com/in/jo%C3%A3o-corr%C3%AAa-buschinelli-14bb59166/" class="text-white">João C. Buschinelli</a>.</p>
</footer>


</body>