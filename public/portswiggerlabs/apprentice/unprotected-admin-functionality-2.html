<!DOCTYPE html>

<html lang="en">
    <head>
        <title>Joao C. Buschinelli</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <meta charset="utf-8">
        <title>Portfolio</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="canonical" href="https://getbootstrap.com/docs/4.0/examples/carousel/">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="vendor/bootstrap/bootstrap.min.css">
        <link rel="stylesheet" href="vendor/select2/select2.min.css">
        <link rel="stylesheet" href="vendor/owlcarousel/owl.carousel.min.css">
        <link rel="stylesheet" href="vendor/lightcase/lightcase.css">
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400|Work+Sans:300,400,700" rel="stylesheet">
        <link rel="stylesheet" href="../../css/style.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.js"></script>
        <script src="../../js/effect.js"></script>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top nav_left">
            <div class="container-fluid">
              <a class="navbar-brand" href="home.html">João Buschinelli</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse flex-d flex-row-reverse nav_right" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                  <a class="nav-link active" aria-current="page" href="../../home.html">Home</a>
                  <a class="nav-link" target="blank" href="https://github.com/buschinelli-joao/">GitHub</a>
                  <a class="nav-link" href="../../PortSwiggerLabs.html">Labs</a>
                  <a class="nav-link" href="../../ctfs.html">CTFs</a>
                  <a class="nav-link" href="../../about.html">About</a>
                </div>
              </div>
            </div>
            </nav>
<div class="jumbotron d-flex align-items-center">
    <div class="container text-center">
        <h1 id="typing-effect" class="display-2 mb-4"></h1>
        <p>
            <b class="solution-title">Solution</b>
        </p>
        <p class="solution-text no-indent">
            This is a lab about privilege escalation, but differently from the last one (check it out <a class="fake-link" target="blank" href="./unprotected-admin-functionality.html">here</a>). 
            here</a>), now the lab tells us that there is a vulnerable admin-panel page that is disclosed somewhere in the website application.
            You can access
            it by clicking <a class="fake-link" target="blank" href="https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality-with-unpredictable-url">here</a>. Once we launch the lab, we are welcomed by the page: 
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/priv-esc-unprotected-admin-func-url-1.png">
        </div>
        <p class="solution-text no-indent">
            At a first glance on the requests of the home page captured by BurpSuite, we see that there is nothing really interesting. To find if there is an
            actual disclosed information in a script in the website, we can inspect the page and look for directories (other than the preset ones) that would lead to 
            that script.
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/priv-esc-unprotected-admin-func-url-2.png">
        </div>
        <p class="solution-text no-indent">
            Note that in the body tag we have a script running called "labHeader.js", and the code reflects the source directory that this script is located at.
            Let's try to access it.
        </p>
        <div class="fig-breath">
            <img class="fig-body" src="../../Images/priv-esc-unprotected-admin-func-url-3.png">
        </div>
        <p class="solution-text no-indent">
            We can see the source JavaScript code, but this is not the one we are looking for. This is just to set the lab headers correctly, I guess.
            Let us inspect a little further the main page to see if there is an actual script hidden in it. After navigating a while, we should be 
            able to find the following html:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="../../Images/priv-esc-unprotected-admin-func-url-4.png">
        </div>
        <p class="solution-text no-indent">
            This JavaScript is the one responsible to restrict access to certain pages if user is not administrator. But look that there is an information disclosure
            here: it says that if the variable isAdmin is true, then it should redirect you to "/admin-y07bab" (this string might change from session to session). We can
            access this page by just appending this directory to the home URL. This is where we arrive at:
        </p>
        <div class="fig-breath" style="text-align: center">
            <img class="fig-body" src="../../Images/priv-esc-unprotected-admin-func-url-5.png">
        </div>
        <p class="solution-text no-indent">
            Now we can see the user's "carlos" account, and a buttton "delete" next to it. After clicking, we solve the lab!
        </p>
        <a href="../../PortSwiggerLabs.html">Go back</a>
    </div>

</div>
<footer class="mt-auto text-white-50">
    
    <p>&copy; 2022<script>new Date().getFullYear()>2022&&document.write("-"+new Date().getFullYear());</script> <a class="text-white">hobo-hacker.com</a>, by <a href="https://www.linkedin.com/in/jo%C3%A3o-corr%C3%AAa-buschinelli-14bb59166/" class="text-white">João C. Buschinelli</a>.</p>
</footer>


</body>
